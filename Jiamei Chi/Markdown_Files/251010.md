# 251010 README

数据集的问题

- 结构化：需要整理为nuclei模板
- nuclei数据集基本上都是指纹验证（即扫描公共域名下的readme.txt，提取服务版本，做版本比较，属于良性poc），属于概念验证，不具备危害性。相反，恶性poc的注入点（在HTTP请求中，注入点一般指URL路径）没有什么规律
- 攻击脚本的质量不一，优质脚本数量较少，需要过滤

```yaml
http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wpdiscuz/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wpdiscuz"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 7.6.33')
```

```yaml
CVE-2020-5722（Grandstream，POST /cgi）

CVE-2020-10220（rConfig，GET /commands.inc.php）

CVE-2020-11530（Chop Slider，GET get_script/index.php）

CVE-2020-13118（Mikrotik RMS，GET check_community.php）

CVE-2021-24762（Perfect Survey，GET admin-ajax.php?action=get_question&question_id=...）

CVE-2021-24931（SCCP，GET admin-ajax.php?action=ays_sccp_results_export_file&sccp_id[]=...）

```

微调上的问题：

- 目前微调仅可以解决payload构造的问题，然而攻击成功需要poc+payload+验证（即找到注入点+开锁成功），如何自动找到poc是目前的研究难点
- 如何自动获得需要的登录验证的HTTP请求（与匿名访问不同，需要登录验证的攻击一般需要多次发送HTTP请求，除了需要正确的账号密码外，对登录认证状态的判别方式也不一样），需要增加优质脚本数据进行微调
